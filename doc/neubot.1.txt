neubot
^^^^^^

The network neutrality bot
''''''''''''''''''''''''''

..
.. Copyright (c) 2010-2013
..     Nexa Center for Internet & Society, Politecnico di Torino (DAUIN)
..     and Simone Basso <bassosimone@gmail.com>
..
.. This file is part of Neubot <http://www.neubot.org/>.
..
.. Neubot is free software: you can redistribute it and/or modify
.. it under the terms of the GNU General Public License as published by
.. the Free Software Foundation, either version 3 of the License, or
.. (at your option) any later version.
..
.. Neubot is distributed in the hope that it will be useful,
.. but WITHOUT ANY WARRANTY; without even the implied warranty of
.. MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.. GNU General Public License for more details.
..
.. You should have received a copy of the GNU General Public License
.. along with Neubot.  If not, see <http://www.gnu.org/licenses/>.
..

:Manual section: 1
:Date: @DATE@
:Manual group: Neubot manual
:Version: Neubot 0.4.15.7

SYNOPSIS
````````

|   **neubot** **--help**
|   **neubot** **-V**
|   **neubot** *subcommand* ...

DESCRIPTION
```````````

Neubot (the network neutrality bot) is a free-software Internet bot
that gathers network performance data useful to investigate network
neutrality.  It runs in the background and periodically performs
active network tests with test servers (see the `Implemented
tests`_ section).

Neubot tests results contain the user's IP address that is personal
data in the European Union. Therefore, Neubot does not perform any
test until the user provides his/her informed consent (see
PRIVACY_).

When Neubot is running, you can interact with it either using its
subcommands (see `SUBCOMMANDS`_) or using directly the Web API (see
`WEB API`_). The Web API is available at the *Neubot endpoint*;
i.e., the endpoint where Neubot is listening. This endpoint is
*127.0.0.1:9774* by default, and you can edit `$CONFIG/api` to
change its value (see `FILES`_).

On UNIX systems, Neubot forks off an unprivileged child to run
network tests. This child runs as the unprivileged _neubot user.
You can edit `$CONFDIR/users` to change the unprivileged user name
(see `FILES`_).

The first form of the command (`neubot --help`) prints on the
standard output a brief help message. The second form of the command
(`neubot -V`) prints on the standard output the version number.  The
third form of the command (`neubot subcommand...`) runs the specified
`subcommand`.

SUBCOMMANDS
```````````

Here we document Neubot subcommands.

neubot bittorrent [-6fv] [-A address] [-p port]
  This command connects to the Neubot endpoint and requests Neubot
  to run a *bittorrent* test using the *runner* Web API.

  This command accepts the following command line options:

    -6
      Prefer IPv6 to IPv4.

    -A address
      Address of the remote test server.

    -f
      Force. Run the command in the local process context (i.e, don't use
      the Web API) and override privacy settings if needed.

    -p
      Port of the remote test server.

    -v
      Make the command more verbose.

neubot raw [-6fv] [-A address] [-p port]
  This command connects to the Neubot endpoint and requests Neubot
  to run a *raw* test using the *runner* Web API.

  This command accepts the following command line options:

    -6
      Prefer IPv6 to IPv4.

    -A address
      Address of the remote test server.

    -f
      Force. Run the command in the local process context (i.e, don't use
      the Web API) and override privacy settings if needed.

    -p
      Port of the remote test server.

    -v
      Make the command more verbose.

neubot speedtest [-6fv] [-A address] [-p port]
  This command connects to the Neubot endpoint and requests Neubot
  to run a *speedtest* test using the *runner* Web API.

  This command accepts the following command line options:

    -6
      Prefer IPv6 to IPv4.

    -A address
      Address of the remote test server.

    -f
      Force. Run the command in the local process context (i.e, don't use
      the Web API) and override privacy settings if needed.

    -p
      Port of the remote test server.

    -v
      Make the command more verbose.

neubot start
  *On MacOS* this command runs launchctl(1), which in turn starts
  Neubot. On MacOS, Neubot's installer configures the system to run Neubot
  at startup, which means you don't typically need to run this
  command. You must be root to run this command.

  On MacOS Neubot is implemented by two daemon processes. A privileged
  daemon that forks unprivileged childs to check for updates and an
  unprivileged daemon that performs network tests. The start command
  controls the privileged daemon, which in turn controls the unprivileged
  daemon.

  On MacOS, the start command accepts the following options:

    -d
      Debug. When this flag is specified, Neubot runs in
      the foreground.

    -n
      No auto-updates. When the -n flag is specified, the privileged
      daemon does not check for updates and only controls the
      unprivileged daemon.

    -v
      Verbose. When this flag is specified, the start command
      is verbose (i.e., it prints on the standard error
      the commands it is about to invoke).

      When both -v and -d are specified, Neubot runs in verbose mode
      in the foreground.

  *On Windows*, the start command runs Neubot with the privileges
  of the user that invokes it. On Windows, Neubot's installer configures
  the system to start Neubot when a user logs in. Therefore Neubot
  runs in the context of the user's session.

  On Windows, the start command accepts the following options:

    -k
      Kill. When -k is specified, Neubot kills an already
      running Neubot instance (if any) before starting up.

      This is used by the automatic updates process: once the new
      version of Neubot is downloaded and installed, the old version
      executes it with `start -k`.

  *On other UNIX systems*, the start command forks the Neubot
  damon, which drops privileges and runs in the background.
  On such systems, this command does not accept any command line
  option.

neubot status
  This command connects to the Neubot endpoint and sends a *api*
  Neubot Web API request.  It returns *zero* if connect() succeeds
  and the response is OK, *one* otherwise.

  *On Windows and MacOS* this command accepts the *-v* option,
  which makes it more verbose. *On other UNIX systems*, it does
  not accept any command line option.

neubot stop
  *On MacOS*, this command runs launchctl(1), which in turn stops
  Neubot. You must be root to run this command. On MacOS, this
  command accepts the *-v* option, which makes it more verbose.

  *On Windows and other UNIX systems*, this command connects to the
  Neubot endpoint and sends a *stop* Web API request. In turn, this
  forces Neubot to exit.

neubot database [--help] [-f database] [action]
  Perform low level actions on the database or print the database name
  if no action was specified.  The following options are accepted:

    --help
      Prints an help message on the standard output and exits.

    -f database
      Force to use the database at *database* instead of using the
      default one (see `FILES`_ section for more info).

  The following actions are implemented:

    info
      Print the database path.

    delete_all
      Delete all results in the database.

    dump
      Dump to stdout the content of the database in JSON format.

    prune
      Remove results older than one year from the database.

    regen_uuid
      Each **neubot** has its own random unique identifier that is sent
      with results and allows to perform time serie anlysis.  This action
      generates a fresh new random unique identifier.

    show
      Like *dump*, but pretty-prints database content.

neubot privacy [-Pt] [-D setting] [-f database]
  Allows to read privacy policy, test and set privacy settings.  For
  more information on privacy see the PRIVACY_ section.  This subcommand
  accepts the following command line options:

    -D setting
      Allow to set privacy settings in the database.  The following
      privacy settings are defined, along with their default value:

        privacy.informed=""
          Turns on (*nonzero*) or off (*0*) the corresponding privacy
          setting in the database, unless the setting is unspecified
          (*""*).

        privacy.can_collect=""
          Turns on (*nonzero*) or off (*0*) the corresponding privacy
          setting in the database, unless the setting is unspecified
          (*""*).

        privacy.can_publish=""
          Turns on (*nonzero*) or off (*0*) the corresponding privacy
          setting in the database, unless the setting is unspecified
          (*""*).

      Note that all privacy settings must be on for **neubot** to be
      allowed to run automatic tests.

      Note that this command changes the database, but changes are not
      propagated to the **neubot** instance running in background.

    -f database
      Force to use the database at *database* instead of using the
      default one (see `FILES`_ section for more info).

    -P
      Prints privacy policy on the standard output.

    -t
      Test mode.  Exits with success (exit value *0*) if privacy
      settings allow to run periodic tests.  Exits with failure (exit
      value *nonzero*) otherwise.

neubot viewer [-f file] [-O option]
  Starts a viewer application that embeds the Web User Interface, if
  the dependencies are installed.  By default, the viewer connects to
  *127.0.0.1:9774*, but that can be changed specifying an alternate
  configuration file or overriding options from command line.

  Accepts the following command line options:

    -f file
      Forces to read settings from *file*, instead of using the default
      configuration file ``/etc/neubot/api``.  If the file does not
      exist or contains errors, this subcommand will ignore it and will
      continue with default settings.

      The following options are recognized (here the options are
      represented together with their default values):

        address 127.0.0.1
          Address where the Web API is supposed to be listening.

        port 9774
          Port where the Web API is supposed to be listening.

    -O option
      Overrides configuration file option from the command line,
      see description of **-f** flag for the list of available
      options.

WEB USER INTERFACE
``````````````````

TBD

WEB API
```````

TDB

IMPLEMENTED TESTS
`````````````````

TBD

PRIVACY
```````

.. :Version: 2.0.3

The Neubot project is a research effort that aims to study the quality
and neutrality of ordinary users' Internet connections, to rebalance the
information asymmetry between them and Service Providers.  The Neubot
software (i) *measures* the quality and neutrality of your Internet
connection.  The raw measurement results are (ii) *collected* on the
measurement servers for research purposes and (iii) *published*, to allow
other individuals and institutions to reuse them for research purposes.

To *measure* the quality and neutrality of your Internet connection,
the Neubot software does not monitor or analyze your Internet traffic.
It just uses a fraction of your connection capacity to perform background
transmission tests, sending and/or receiving random data.  The results
contain the measured performance metrics, such as the download speed,
or the latency, as well as your computer load, as a percentage, and
*your Internet address*.

The Internet address is paramount because it allows to *infer your Internet
Service Provider* and to have a rough idea of *your location*, allowing to
put the results in context.  The Neubot project needs to *collect* it
to study the data and wants to *publish* it to enable other individuals
and institutions to carry alternative studies and/or peer-review its
measurements and data analysis methodology.  This is coherent with the
policy of the distributed server platform that empowers the Neubot
project, Measurement Lab (M-Lab), which requires all results to be
released as open data [1]_.

You are reading this privacy policy because Neubot is developed in the
European Union, where there is consensus that Internet addresses are
*personal data*.  This means that the Neubot project cannot store, process
or publish your address without your prior *informed consent*, under the
provisions of the "Codice in materia di protezione dei dati personali"
(Decree 196/03) [2]_.  In accordance with the law, data controller is the
NEXA Center for Internet & Society [3]_, represented by its co-director Juan
Carlos De Martin.

Via its web interface [4]_, the Neubot software asks you (a) to explicitly
assert that you are *informed*, i.e. that you have read the privacy
policy, (b) to give it the permission to *collect* and (c) *publish* your
IP address.  If you don't assert (a) and you don't give the permission
to do (b) and (c), Neubot cannot run tests because, if it did, it would
violate privacy laws and/or Measurement Lab policy.

The data controller guarantees you the rights as per Art. 7 of the
above-mentioned Decree 196/03.  Basically, you have total control over
you personal data, and you can, for example, inquire Neubot to remove
your Internet address from its data sets.  To exercise your rights, please
write to <privacy@neubot.org> or to "NEXA Center for Internet & Society,
Dipartimento di Automatica e Infomatica, Politecnico di Torino, Corso Duca
degli Abruzzi 24, 10129 Turin, ITALY."

.. [1] http://www.measurementlab.net/about
.. [2] http://www.garanteprivacy.it/garante/doc.jsp?ID=1311248
.. [3] http://nexa.polito.it/
.. [4] http://127.0.0.1:9774/privacy.html

EXAMPLES
````````

In this section we will follow the well-established convention of
representing the unprivileged user prompt with *$* and the privileged
user prompt with *#*.

Run ondemand speedtest test:

|
|    $ neubot speedtest

Run ondemand BitTorrent test:

|
|    $ neubot bittorrent

Start **neubot**:

|
|    # neubot start

Stop **neubot**:

|
|    $ neubot stop

Run the client-side components of **neubot** in foreground and in debug
mode for debugging purposes:

|
|    $ neubot agent -v -D agent.daemonize=no

Export system-wide results to JSON:

|
|    # neubot database dump > output.json

Track **neubot** state using the command line:

|
|    $ neubot api.client

Run Neubot in-place from the sources directory:

|
|    $ ./bin/neubot *comand*

FILES
`````

Neubot can be installed below many different prefixes (the most common
ones being **/usr/local** and **/usr**). In this section of the manual
we assume that it has been installed below **/usr/local**:

/usr/local/bin/neubot
  The neubot program, a simple python script that imports neubot and passes
  the control to **neubot.main** module.

/usr/local/share/neubot/*
  Location where neubot python modules are installed.

/usr/local/share/neubot/main/__init__.py
  Well-known location of the real main() of Neubot.  This is the
  standard entry point to Neubot.

/usr/local/share/neubot/updater/unix.py
  Well-known location of the updater daemon for Unix.  This is an
  alternative entry point to Neubot.

/var/neubot/database.sqlite3
  System-wide results database for UNIX systems (except Linux),
  created when the neubot daemon starts for the first time.

/var/lib/neubot/database.sqlite3
  System-wide results database for Linux systems, created when the
  neubot daemon starts for the first time.

BUGS
````

If the default browser is a textual browser and a graphical environment
is available, Neubot will start the web user interface into the
textual browser.  Nine times out of ten this results into an unusable
web user interface because most textual browser do not support
javascript.

Neubot is reported to be "not running" by *neubot start* also when
the response is not *200 Ok*.

AUTHOR
``````

Neubot authors are:

|
| Simone Basso                  <bassosimone@gmail.com>
| Antonio Servetti              <antonio.servetti@polito.it>

The following people have contributed patches to the project:

|
| Alessio Palmero Aprosio	<alessio@apnetwork.it>
| Roberto D'Auria		<everlastingfire@autistici.org>
| Marco Scopesi			<marco.scopesi@gmail.com>

The following people have helped with internationalization:

|
| Claudio Artusio               <claudioartusio@gmail.com>

COPYRIGHT
`````````

| Copyright (c) 2010-2012 NEXA Center for Internet & Society
|   at Politecnico di Torino <http://nexa.polito.it/>

| Neubot is free software: you can redistribute it and/or
| modify it under the terms of the GNU General Public License
| as published by the Free Software Foundation, either version
| 3 of the License, or (at your option) any later version.

SEE ALSO
````````

| ``Neubot | The network neutrality bot <http://www.neubot.org/>``
